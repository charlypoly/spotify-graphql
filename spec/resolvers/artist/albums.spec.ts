import { SpotifyGraphQLClient } from '../../../index';
import * as nock from 'nock';

describe('Resolver : Artist.albums', () => {

  describe('without album_type not provided', () => {
    let artistResponse = {"external_urls":{"spotify":"https://open.spotify.com/artist/4Nrd0CtP8txoQhnnlRA6V6"},"followers":{"href":null,"total":26173},"genres":["chanson","francoton","french pop"],"href":"https://api.spotify.com/v1/artists/4Nrd0CtP8txoQhnnlRA6V6","id":"4Nrd0CtP8txoQhnnlRA6V6","images":[{"height":640,"url":"https://i.scdn.co/image/04a3710c72c5d52ede6c041d6518caf6c2afebb3","width":640},{"height":320,"url":"https://i.scdn.co/image/cb26c452dbbbb288c3b038c2dbbf1f8ebff020fa","width":320},{"height":160,"url":"https://i.scdn.co/image/2fb2ecbeb147116928f77efcd419baf5ed79875c","width":160}],"name":"Vianney","popularity":66,"type":"artist","uri":"spotify:artist:4Nrd0CtP8txoQhnnlRA6V6"};
    let artistAlbums = {"href":"https://api.spotify.com/v1/artists/4Nrd0CtP8txoQhnnlRA6V6/albums?offset=0&limit=20&album_type=single,album,compilation,appears_on,ep","items":[{"album_type":"album","artists":[{"external_urls":{"spotify":"https://open.spotify.com/artist/4Nrd0CtP8txoQhnnlRA6V6"},"href":"https://api.spotify.com/v1/artists/4Nrd0CtP8txoQhnnlRA6V6","id":"4Nrd0CtP8txoQhnnlRA6V6","name":"Vianney","type":"artist","uri":"spotify:artist:4Nrd0CtP8txoQhnnlRA6V6"}],"available_markets":["AD","AR","AT","AU","BE","BG","BO","BR","CH","CL","CO","CR","CY","CZ","DE","DK","DO","EC","EE","ES","FI","FR","GB","GR","GT","HK","HN","HU","ID","IE","IS","IT","JP","LI","LT","LU","LV","MC","MT","MX","MY","NI","NL","NO","NZ","PA","PE","PH","PL","PT","PY","SE","SG","SK","SV","TR","TW","US","UY"],"external_urls":{"spotify":"https://open.spotify.com/album/3sb3TaTkw7pdVD2V5cSBGi"},"href":"https://api.spotify.com/v1/albums/3sb3TaTkw7pdVD2V5cSBGi","id":"3sb3TaTkw7pdVD2V5cSBGi","images":[{"height":640,"url":"https://i.scdn.co/image/c250c6d9f4db5ca5641af9321c935bc1999d0c5e","width":640},{"height":300,"url":"https://i.scdn.co/image/bc872b03d4e9ec1c2bf2a7ee908c5162cff43a18","width":300},{"height":64,"url":"https://i.scdn.co/image/0ee4ae93b3b3a022225be832c459c4486c4a989e","width":64}],"name":"Vianney","type":"album","uri":"spotify:album:3sb3TaTkw7pdVD2V5cSBGi"},{"album_type":"album","artists":[{"external_urls":{"spotify":"https://open.spotify.com/artist/4Nrd0CtP8txoQhnnlRA6V6"},"href":"https://api.spotify.com/v1/artists/4Nrd0CtP8txoQhnnlRA6V6","id":"4Nrd0CtP8txoQhnnlRA6V6","name":"Vianney","type":"artist","uri":"spotify:artist:4Nrd0CtP8txoQhnnlRA6V6"}],"available_markets":["CA"],"external_urls":{"spotify":"https://open.spotify.com/album/3E6zAPFDThiqWY7SXEYtZU"},"href":"https://api.spotify.com/v1/albums/3E6zAPFDThiqWY7SXEYtZU","id":"3E6zAPFDThiqWY7SXEYtZU","images":[{"height":640,"url":"https://i.scdn.co/image/b4fc75db830214799c5f693348cbd03200502ac0","width":640},{"height":300,"url":"https://i.scdn.co/image/904dc16a2a53b0baceb14c9da81c2eb2934dd11b","width":300},{"height":64,"url":"https://i.scdn.co/image/b02ada3709e94e3dcc9356405410f0481bbe2728","width":64}],"name":"Vianney","type":"album","uri":"spotify:album:3E6zAPFDThiqWY7SXEYtZU"},{"album_type":"album","artists":[{"external_urls":{"spotify":"https://open.spotify.com/artist/4Nrd0CtP8txoQhnnlRA6V6"},"href":"https://api.spotify.com/v1/artists/4Nrd0CtP8txoQhnnlRA6V6","id":"4Nrd0CtP8txoQhnnlRA6V6","name":"Vianney","type":"artist","uri":"spotify:artist:4Nrd0CtP8txoQhnnlRA6V6"}],"available_markets":["AD","AR","AU","BE","BG","BO","BR","CH","CL","CO","CR","CY","CZ","DK","DO","EC","EE","ES","FI","FR","GB","GR","GT","HK","HN","HU","ID","IE","IS","IT","JP","LI","LT","LU","LV","MC","MT","MX","MY","NI","NL","NO","NZ","PA","PE","PH","PL","PT","PY","SE","SG","SK","SV","TR","TW","US","UY"],"external_urls":{"spotify":"https://open.spotify.com/album/2ZbA2Pic7Sh9gGmLk5S2Ni"},"href":"https://api.spotify.com/v1/albums/2ZbA2Pic7Sh9gGmLk5S2Ni","id":"2ZbA2Pic7Sh9gGmLk5S2Ni","images":[{"height":640,"url":"https://i.scdn.co/image/0e97b12bef3aa30fd8c35181de89033fcaaf75a3","width":640},{"height":300,"url":"https://i.scdn.co/image/a17308bb5f14b9b546ad21e0873c1ab87844a248","width":300},{"height":64,"url":"https://i.scdn.co/image/24e897c73127f4f40797a4a9e4d58179aa5ae4d0","width":64}],"name":"Idées blanches (Nouvelle édition)","type":"album","uri":"spotify:album:2ZbA2Pic7Sh9gGmLk5S2Ni"},{"album_type":"album","artists":[{"external_urls":{"spotify":"https://open.spotify.com/artist/4Nrd0CtP8txoQhnnlRA6V6"},"href":"https://api.spotify.com/v1/artists/4Nrd0CtP8txoQhnnlRA6V6","id":"4Nrd0CtP8txoQhnnlRA6V6","name":"Vianney","type":"artist","uri":"spotify:artist:4Nrd0CtP8txoQhnnlRA6V6"}],"available_markets":["AD","AR","AU","BE","BG","BO","BR","CH","CL","CO","CR","CY","CZ","DK","DO","EC","EE","ES","FI","FR","GB","GR","GT","HK","HN","HU","ID","IE","IS","IT","JP","LI","LT","LU","LV","MC","MT","MX","MY","NI","NL","NO","NZ","PA","PE","PH","PL","PT","PY","SE","SG","SK","SV","TR","TW","US","UY"],"external_urls":{"spotify":"https://open.spotify.com/album/3Bqz1JqZLqYa2YvZYhs8PS"},"href":"https://api.spotify.com/v1/albums/3Bqz1JqZLqYa2YvZYhs8PS","id":"3Bqz1JqZLqYa2YvZYhs8PS","images":[{"height":640,"url":"https://i.scdn.co/image/c7b4375a6e08b51c7824b58e94a68fbb65fe05a1","width":640},{"height":300,"url":"https://i.scdn.co/image/00fb3a69882377d85b09e5d8396f9baaa45068cb","width":300},{"height":64,"url":"https://i.scdn.co/image/cf67927286df32edf4aed917c7e3fdb82f1428db","width":64}],"name":"Idées blanches (Les acoustiques)","type":"album","uri":"spotify:album:3Bqz1JqZLqYa2YvZYhs8PS"},{"album_type":"album","artists":[{"external_urls":{"spotify":"https://open.spotify.com/artist/4Nrd0CtP8txoQhnnlRA6V6"},"href":"https://api.spotify.com/v1/artists/4Nrd0CtP8txoQhnnlRA6V6","id":"4Nrd0CtP8txoQhnnlRA6V6","name":"Vianney","type":"artist","uri":"spotify:artist:4Nrd0CtP8txoQhnnlRA6V6"}],"available_markets":["CA"],"external_urls":{"spotify":"https://open.spotify.com/album/7hokJqnY7z96AL7mCyZWah"},"href":"https://api.spotify.com/v1/albums/7hokJqnY7z96AL7mCyZWah","id":"7hokJqnY7z96AL7mCyZWah","images":[{"height":640,"url":"https://i.scdn.co/image/34f599124c1e3dc6626b7eee7b6dc39c0dce3e05","width":640},{"height":300,"url":"https://i.scdn.co/image/88052cd7a5358f92adb399703aac1d857a1d3fb2","width":300},{"height":64,"url":"https://i.scdn.co/image/d8e20210330e13108aa3860d34917acefd92b5a6","width":64}],"name":"Idées Blanches (les acoustiques)","type":"album","uri":"spotify:album:7hokJqnY7z96AL7mCyZWah"},{"album_type":"album","artists":[{"external_urls":{"spotify":"https://open.spotify.com/artist/4Nrd0CtP8txoQhnnlRA6V6"},"href":"https://api.spotify.com/v1/artists/4Nrd0CtP8txoQhnnlRA6V6","id":"4Nrd0CtP8txoQhnnlRA6V6","name":"Vianney","type":"artist","uri":"spotify:artist:4Nrd0CtP8txoQhnnlRA6V6"}],"available_markets":["AD","AR","AU","BE","BG","BO","BR","CH","CL","CO","CR","CY","CZ","DK","DO","EC","EE","ES","FI","FR","GB","GR","GT","HK","HN","HU","ID","IE","IS","IT","JP","LI","LT","LU","LV","MC","MT","MX","MY","NI","NL","NO","NZ","PA","PE","PH","PL","PT","PY","SE","SG","SK","SV","TR","TW","US","UY"],"external_urls":{"spotify":"https://open.spotify.com/album/0VvfkgvAZ2STc0EyVOVi4P"},"href":"https://api.spotify.com/v1/albums/0VvfkgvAZ2STc0EyVOVi4P","id":"0VvfkgvAZ2STc0EyVOVi4P","images":[{"height":640,"url":"https://i.scdn.co/image/0e97b12bef3aa30fd8c35181de89033fcaaf75a3","width":640},{"height":300,"url":"https://i.scdn.co/image/a17308bb5f14b9b546ad21e0873c1ab87844a248","width":300},{"height":64,"url":"https://i.scdn.co/image/24e897c73127f4f40797a4a9e4d58179aa5ae4d0","width":64}],"name":"Idées blanches (Edition deluxe)","type":"album","uri":"spotify:album:0VvfkgvAZ2STc0EyVOVi4P"},{"album_type":"album","artists":[{"external_urls":{"spotify":"https://open.spotify.com/artist/4Nrd0CtP8txoQhnnlRA6V6"},"href":"https://api.spotify.com/v1/artists/4Nrd0CtP8txoQhnnlRA6V6","id":"4Nrd0CtP8txoQhnnlRA6V6","name":"Vianney","type":"artist","uri":"spotify:artist:4Nrd0CtP8txoQhnnlRA6V6"}],"available_markets":["CA"],"external_urls":{"spotify":"https://open.spotify.com/album/4tym098FRHW7QfCz2t0FST"},"href":"https://api.spotify.com/v1/albums/4tym098FRHW7QfCz2t0FST","id":"4tym098FRHW7QfCz2t0FST","images":[{"height":640,"url":"https://i.scdn.co/image/670c6ca0f24299964b6fae923c81fe7cefffd05c","width":640},{"height":300,"url":"https://i.scdn.co/image/ef3680fdb677e2b9f7463b9deeb3aa7052deda05","width":300},{"height":64,"url":"https://i.scdn.co/image/94345024301e954b8b64567894ead4081bd314b3","width":64}],"name":"Idées blanches (Édition deluxe)","type":"album","uri":"spotify:album:4tym098FRHW7QfCz2t0FST"},{"album_type":"album","artists":[{"external_urls":{"spotify":"https://open.spotify.com/artist/4Nrd0CtP8txoQhnnlRA6V6"},"href":"https://api.spotify.com/v1/artists/4Nrd0CtP8txoQhnnlRA6V6","id":"4Nrd0CtP8txoQhnnlRA6V6","name":"Vianney","type":"artist","uri":"spotify:artist:4Nrd0CtP8txoQhnnlRA6V6"}],"available_markets":["AT","CH","DE"],"external_urls":{"spotify":"https://open.spotify.com/album/3PZh3KWGiadJqfMCI5N8sL"},"href":"https://api.spotify.com/v1/albums/3PZh3KWGiadJqfMCI5N8sL","id":"3PZh3KWGiadJqfMCI5N8sL","images":[{"height":640,"url":"https://i.scdn.co/image/8e2dda34bcb7c08794e0245390d3c8f243388cd8","width":640},{"height":300,"url":"https://i.scdn.co/image/eb926cf99d83addb5581e64dd47fc77675db0812","width":300},{"height":64,"url":"https://i.scdn.co/image/4076d0bfa9497f73fe412ebbb085eef291c2f277","width":64}],"name":"Idées blanches","type":"album","uri":"spotify:album:3PZh3KWGiadJqfMCI5N8sL"},{"album_type":"album","artists":[{"external_urls":{"spotify":"https://open.spotify.com/artist/4Nrd0CtP8txoQhnnlRA6V6"},"href":"https://api.spotify.com/v1/artists/4Nrd0CtP8txoQhnnlRA6V6","id":"4Nrd0CtP8txoQhnnlRA6V6","name":"Vianney","type":"artist","uri":"spotify:artist:4Nrd0CtP8txoQhnnlRA6V6"}],"available_markets":["AD","AR","AU","BE","BG","BO","BR","CL","CO","CR","CY","CZ","DK","DO","EC","EE","ES","FI","FR","GB","GR","GT","HK","HN","HU","ID","IE","IS","IT","JP","LI","LT","LU","LV","MC","MT","MX","MY","NI","NL","NO","NZ","PA","PE","PH","PL","PT","PY","SE","SG","SK","SV","TR","TW","US","UY"],"external_urls":{"spotify":"https://open.spotify.com/album/3UIXocl30yFAZd7wqQNmu7"},"href":"https://api.spotify.com/v1/albums/3UIXocl30yFAZd7wqQNmu7","id":"3UIXocl30yFAZd7wqQNmu7","images":[{"height":640,"url":"https://i.scdn.co/image/acee8e6eaf3e2b2b0e427711872c3e43be8c993a","width":640},{"height":300,"url":"https://i.scdn.co/image/42affa8b481f0a2905c4feebc09b7483b8991b8b","width":300},{"height":64,"url":"https://i.scdn.co/image/c784886d760273a6037cf8d53d1a84dde1ecdfb5","width":64}],"name":"Idées blanches","type":"album","uri":"spotify:album:3UIXocl30yFAZd7wqQNmu7"},{"album_type":"album","artists":[{"external_urls":{"spotify":"https://open.spotify.com/artist/4Nrd0CtP8txoQhnnlRA6V6"},"href":"https://api.spotify.com/v1/artists/4Nrd0CtP8txoQhnnlRA6V6","id":"4Nrd0CtP8txoQhnnlRA6V6","name":"Vianney","type":"artist","uri":"spotify:artist:4Nrd0CtP8txoQhnnlRA6V6"}],"available_markets":["CA"],"external_urls":{"spotify":"https://open.spotify.com/album/4JHgWFaX6K0LsNhmNUblr5"},"href":"https://api.spotify.com/v1/albums/4JHgWFaX6K0LsNhmNUblr5","id":"4JHgWFaX6K0LsNhmNUblr5","images":[{"height":640,"url":"https://i.scdn.co/image/acee8e6eaf3e2b2b0e427711872c3e43be8c993a","width":640},{"height":300,"url":"https://i.scdn.co/image/42affa8b481f0a2905c4feebc09b7483b8991b8b","width":300},{"height":64,"url":"https://i.scdn.co/image/c784886d760273a6037cf8d53d1a84dde1ecdfb5","width":64}],"name":"Idées blanches","type":"album","uri":"spotify:album:4JHgWFaX6K0LsNhmNUblr5"},{"album_type":"album","artists":[{"external_urls":{"spotify":"https://open.spotify.com/artist/4Nrd0CtP8txoQhnnlRA6V6"},"href":"https://api.spotify.com/v1/artists/4Nrd0CtP8txoQhnnlRA6V6","id":"4Nrd0CtP8txoQhnnlRA6V6","name":"Vianney","type":"artist","uri":"spotify:artist:4Nrd0CtP8txoQhnnlRA6V6"}],"available_markets":["CA"],"external_urls":{"spotify":"https://open.spotify.com/album/69WTHulh0KBAm0yaXrXxbs"},"href":"https://api.spotify.com/v1/albums/69WTHulh0KBAm0yaXrXxbs","id":"69WTHulh0KBAm0yaXrXxbs","images":[{"height":640,"url":"https://i.scdn.co/image/acee8e6eaf3e2b2b0e427711872c3e43be8c993a","width":640},{"height":300,"url":"https://i.scdn.co/image/42affa8b481f0a2905c4feebc09b7483b8991b8b","width":300},{"height":64,"url":"https://i.scdn.co/image/c784886d760273a6037cf8d53d1a84dde1ecdfb5","width":64}],"name":"Idées blanches","type":"album","uri":"spotify:album:69WTHulh0KBAm0yaXrXxbs"},{"album_type":"single","artists":[{"external_urls":{"spotify":"https://open.spotify.com/artist/4Nrd0CtP8txoQhnnlRA6V6"},"href":"https://api.spotify.com/v1/artists/4Nrd0CtP8txoQhnnlRA6V6","id":"4Nrd0CtP8txoQhnnlRA6V6","name":"Vianney","type":"artist","uri":"spotify:artist:4Nrd0CtP8txoQhnnlRA6V6"}],"available_markets":["AD","AR","AT","AU","BE","BG","BO","BR","CH","CL","CO","CR","CY","CZ","DE","DK","DO","EC","EE","ES","FI","FR","GB","GR","GT","HK","HN","HU","ID","IE","IS","IT","JP","LI","LT","LU","LV","MC","MT","MX","MY","NI","NL","NO","NZ","PA","PE","PH","PL","PT","PY","SE","SG","SK","SV","TR","TW","US","UY"],"external_urls":{"spotify":"https://open.spotify.com/album/4kn8D9C3PfapNKUtbsNsLp"},"href":"https://api.spotify.com/v1/albums/4kn8D9C3PfapNKUtbsNsLp","id":"4kn8D9C3PfapNKUtbsNsLp","images":[{"height":640,"url":"https://i.scdn.co/image/c250c6d9f4db5ca5641af9321c935bc1999d0c5e","width":640},{"height":300,"url":"https://i.scdn.co/image/bc872b03d4e9ec1c2bf2a7ee908c5162cff43a18","width":300},{"height":64,"url":"https://i.scdn.co/image/0ee4ae93b3b3a022225be832c459c4486c4a989e","width":64}],"name":"Dumbo - Single","type":"album","uri":"spotify:album:4kn8D9C3PfapNKUtbsNsLp"},{"album_type":"single","artists":[{"external_urls":{"spotify":"https://open.spotify.com/artist/4Nrd0CtP8txoQhnnlRA6V6"},"href":"https://api.spotify.com/v1/artists/4Nrd0CtP8txoQhnnlRA6V6","id":"4Nrd0CtP8txoQhnnlRA6V6","name":"Vianney","type":"artist","uri":"spotify:artist:4Nrd0CtP8txoQhnnlRA6V6"}],"available_markets":["CA"],"external_urls":{"spotify":"https://open.spotify.com/album/5nRYhESUfFjDUcWlpx7RbS"},"href":"https://api.spotify.com/v1/albums/5nRYhESUfFjDUcWlpx7RbS","id":"5nRYhESUfFjDUcWlpx7RbS","images":[{"height":640,"url":"https://i.scdn.co/image/b4fc75db830214799c5f693348cbd03200502ac0","width":640},{"height":300,"url":"https://i.scdn.co/image/904dc16a2a53b0baceb14c9da81c2eb2934dd11b","width":300},{"height":64,"url":"https://i.scdn.co/image/b02ada3709e94e3dcc9356405410f0481bbe2728","width":64}],"name":"Dumbo - Single","type":"album","uri":"spotify:album:5nRYhESUfFjDUcWlpx7RbS"},{"album_type":"single","artists":[{"external_urls":{"spotify":"https://open.spotify.com/artist/4Nrd0CtP8txoQhnnlRA6V6"},"href":"https://api.spotify.com/v1/artists/4Nrd0CtP8txoQhnnlRA6V6","id":"4Nrd0CtP8txoQhnnlRA6V6","name":"Vianney","type":"artist","uri":"spotify:artist:4Nrd0CtP8txoQhnnlRA6V6"}],"available_markets":["CA"],"external_urls":{"spotify":"https://open.spotify.com/album/2DQFGiig6bHjMq2xPG6xk9"},"href":"https://api.spotify.com/v1/albums/2DQFGiig6bHjMq2xPG6xk9","id":"2DQFGiig6bHjMq2xPG6xk9","images":[{"height":640,"url":"https://i.scdn.co/image/b4fc75db830214799c5f693348cbd03200502ac0","width":640},{"height":300,"url":"https://i.scdn.co/image/904dc16a2a53b0baceb14c9da81c2eb2934dd11b","width":300},{"height":64,"url":"https://i.scdn.co/image/b02ada3709e94e3dcc9356405410f0481bbe2728","width":64}],"name":"Tombe la neige - Single","type":"album","uri":"spotify:album:2DQFGiig6bHjMq2xPG6xk9"},{"album_type":"single","artists":[{"external_urls":{"spotify":"https://open.spotify.com/artist/4Nrd0CtP8txoQhnnlRA6V6"},"href":"https://api.spotify.com/v1/artists/4Nrd0CtP8txoQhnnlRA6V6","id":"4Nrd0CtP8txoQhnnlRA6V6","name":"Vianney","type":"artist","uri":"spotify:artist:4Nrd0CtP8txoQhnnlRA6V6"}],"available_markets":["AD","AR","AT","AU","BE","BG","BO","BR","CH","CL","CO","CR","CY","CZ","DE","DK","DO","EC","EE","ES","FI","FR","GB","GR","GT","HK","HN","HU","ID","IE","IS","IT","JP","LI","LT","LU","LV","MC","MT","MX","MY","NI","NL","NO","NZ","PA","PE","PH","PL","PT","PY","SE","SG","SK","SV","TR","TW","US","UY"],"external_urls":{"spotify":"https://open.spotify.com/album/51a4jnVs7fai1W9EqxjqRY"},"href":"https://api.spotify.com/v1/albums/51a4jnVs7fai1W9EqxjqRY","id":"51a4jnVs7fai1W9EqxjqRY","images":[{"height":640,"url":"https://i.scdn.co/image/c250c6d9f4db5ca5641af9321c935bc1999d0c5e","width":640},{"height":300,"url":"https://i.scdn.co/image/bc872b03d4e9ec1c2bf2a7ee908c5162cff43a18","width":300},{"height":64,"url":"https://i.scdn.co/image/0ee4ae93b3b3a022225be832c459c4486c4a989e","width":64}],"name":"Le fils à papa - Single","type":"album","uri":"spotify:album:51a4jnVs7fai1W9EqxjqRY"},{"album_type":"single","artists":[{"external_urls":{"spotify":"https://open.spotify.com/artist/4Nrd0CtP8txoQhnnlRA6V6"},"href":"https://api.spotify.com/v1/artists/4Nrd0CtP8txoQhnnlRA6V6","id":"4Nrd0CtP8txoQhnnlRA6V6","name":"Vianney","type":"artist","uri":"spotify:artist:4Nrd0CtP8txoQhnnlRA6V6"}],"available_markets":["CA"],"external_urls":{"spotify":"https://open.spotify.com/album/7tmECjYl9kmN0nXoMd4HIv"},"href":"https://api.spotify.com/v1/albums/7tmECjYl9kmN0nXoMd4HIv","id":"7tmECjYl9kmN0nXoMd4HIv","images":[{"height":640,"url":"https://i.scdn.co/image/b4fc75db830214799c5f693348cbd03200502ac0","width":640},{"height":300,"url":"https://i.scdn.co/image/904dc16a2a53b0baceb14c9da81c2eb2934dd11b","width":300},{"height":64,"url":"https://i.scdn.co/image/b02ada3709e94e3dcc9356405410f0481bbe2728","width":64}],"name":"Le fils à papa - Single","type":"album","uri":"spotify:album:7tmECjYl9kmN0nXoMd4HIv"},{"album_type":"single","artists":[{"external_urls":{"spotify":"https://open.spotify.com/artist/4Nrd0CtP8txoQhnnlRA6V6"},"href":"https://api.spotify.com/v1/artists/4Nrd0CtP8txoQhnnlRA6V6","id":"4Nrd0CtP8txoQhnnlRA6V6","name":"Vianney","type":"artist","uri":"spotify:artist:4Nrd0CtP8txoQhnnlRA6V6"}],"available_markets":["AD","AR","AU","BE","BG","BO","BR","CL","CO","CR","CY","CZ","DK","DO","EC","EE","ES","FI","FR","GB","GR","GT","HK","HN","HU","ID","IE","IS","IT","JP","LI","LT","LU","LV","MC","MT","MX","MY","NI","NL","NO","NZ","PA","PE","PH","PL","PT","PY","SE","SG","SK","SV","TR","TW","US","UY"],"external_urls":{"spotify":"https://open.spotify.com/album/4PjzLR7aNOp49fLvTueyB2"},"href":"https://api.spotify.com/v1/albums/4PjzLR7aNOp49fLvTueyB2","id":"4PjzLR7aNOp49fLvTueyB2","images":[{"height":640,"url":"https://i.scdn.co/image/c250c6d9f4db5ca5641af9321c935bc1999d0c5e","width":640},{"height":300,"url":"https://i.scdn.co/image/bc872b03d4e9ec1c2bf2a7ee908c5162cff43a18","width":300},{"height":64,"url":"https://i.scdn.co/image/0ee4ae93b3b3a022225be832c459c4486c4a989e","width":64}],"name":"Je m'en vais - Single","type":"album","uri":"spotify:album:4PjzLR7aNOp49fLvTueyB2"},{"album_type":"single","artists":[{"external_urls":{"spotify":"https://open.spotify.com/artist/4Nrd0CtP8txoQhnnlRA6V6"},"href":"https://api.spotify.com/v1/artists/4Nrd0CtP8txoQhnnlRA6V6","id":"4Nrd0CtP8txoQhnnlRA6V6","name":"Vianney","type":"artist","uri":"spotify:artist:4Nrd0CtP8txoQhnnlRA6V6"}],"available_markets":["CA"],"external_urls":{"spotify":"https://open.spotify.com/album/3iSNhMq7oQYtalgNicW2hv"},"href":"https://api.spotify.com/v1/albums/3iSNhMq7oQYtalgNicW2hv","id":"3iSNhMq7oQYtalgNicW2hv","images":[{"height":640,"url":"https://i.scdn.co/image/b4fc75db830214799c5f693348cbd03200502ac0","width":640},{"height":300,"url":"https://i.scdn.co/image/904dc16a2a53b0baceb14c9da81c2eb2934dd11b","width":300},{"height":64,"url":"https://i.scdn.co/image/b02ada3709e94e3dcc9356405410f0481bbe2728","width":64}],"name":"Je m'en vais - Single","type":"album","uri":"spotify:album:3iSNhMq7oQYtalgNicW2hv"},{"album_type":"single","artists":[{"external_urls":{"spotify":"https://open.spotify.com/artist/4Nrd0CtP8txoQhnnlRA6V6"},"href":"https://api.spotify.com/v1/artists/4Nrd0CtP8txoQhnnlRA6V6","id":"4Nrd0CtP8txoQhnnlRA6V6","name":"Vianney","type":"artist","uri":"spotify:artist:4Nrd0CtP8txoQhnnlRA6V6"}],"available_markets":["AD","AR","AU","BE","BG","BO","BR","CH","CL","CO","CR","CY","CZ","DK","DO","EC","EE","ES","FI","FR","GB","GR","GT","HK","HN","HU","ID","IE","IS","IT","JP","LI","LT","LU","LV","MC","MT","MX","MY","NI","NL","NO","NZ","PA","PE","PH","PL","PT","PY","SE","SG","SK","SV","TR","TW","US","UY"],"external_urls":{"spotify":"https://open.spotify.com/album/7k78KcpuUJHH4bRRQfHzlO"},"href":"https://api.spotify.com/v1/albums/7k78KcpuUJHH4bRRQfHzlO","id":"7k78KcpuUJHH4bRRQfHzlO","images":[{"height":640,"url":"https://i.scdn.co/image/c7b4375a6e08b51c7824b58e94a68fbb65fe05a1","width":640},{"height":300,"url":"https://i.scdn.co/image/00fb3a69882377d85b09e5d8396f9baaa45068cb","width":300},{"height":64,"url":"https://i.scdn.co/image/cf67927286df32edf4aed917c7e3fdb82f1428db","width":64}],"name":"Je te déteste (Acoustique) - Single","type":"album","uri":"spotify:album:7k78KcpuUJHH4bRRQfHzlO"},{"album_type":"single","artists":[{"external_urls":{"spotify":"https://open.spotify.com/artist/4Nrd0CtP8txoQhnnlRA6V6"},"href":"https://api.spotify.com/v1/artists/4Nrd0CtP8txoQhnnlRA6V6","id":"4Nrd0CtP8txoQhnnlRA6V6","name":"Vianney","type":"artist","uri":"spotify:artist:4Nrd0CtP8txoQhnnlRA6V6"}],"available_markets":["AD","AR","AU","BE","BG","BO","BR","CH","CL","CO","CR","CY","CZ","DK","DO","EC","EE","ES","FI","FR","GB","GR","GT","HK","HN","HU","ID","IE","IS","IT","JP","LI","LT","LU","LV","MC","MT","MX","MY","NI","NL","NO","NZ","PA","PE","PH","PL","PT","PY","SE","SG","SK","SV","TR","TW","US","UY"],"external_urls":{"spotify":"https://open.spotify.com/album/74lxSilf4sP7cJbHyoPBzD"},"href":"https://api.spotify.com/v1/albums/74lxSilf4sP7cJbHyoPBzD","id":"74lxSilf4sP7cJbHyoPBzD","images":[{"height":640,"url":"https://i.scdn.co/image/c7b4375a6e08b51c7824b58e94a68fbb65fe05a1","width":640},{"height":300,"url":"https://i.scdn.co/image/00fb3a69882377d85b09e5d8396f9baaa45068cb","width":300},{"height":64,"url":"https://i.scdn.co/image/cf67927286df32edf4aed917c7e3fdb82f1428db","width":64}],"name":"Man Down (Acoustique) - Single","type":"album","uri":"spotify:album:74lxSilf4sP7cJbHyoPBzD"}],"limit":20,"next":"https://api.spotify.com/v1/artists/4Nrd0CtP8txoQhnnlRA6V6/albums?offset=20&limit=20&album_type=single,album,compilation,appears_on,ep","offset":0,"previous":null,"total":40};

    nock.disableNetConnect();

    let client = SpotifyGraphQLClient({
      clientId: "clientId",
      clientSecret: "clientSecret",
      redirectUri: "http://redirectUri.dev",
      accessToken: "accessToken"
    });


    describe('when fetching an existing Artist', () => {
      let artistRequest, artistAlbumsRequest;
      beforeEach(() => {
        artistRequest = nock('https://api.spotify.com:443')
          .get('/v1/artists/4Nrd0CtP8txoQhnnlRA6V6')
          .reply(200, artistResponse);
        artistAlbumsRequest = nock('https://api.spotify.com:443')
          .get('/v1/artists/4Nrd0CtP8txoQhnnlRA6V6/albums?offset=0&limit=50')
          .reply(200, artistAlbums);
      });
      afterEach(() =>  {
        nock.cleanAll();
      });

      it('should call promise success callback', (done) => {
        let onSuccess = function (executionResult: any) {
          let data = executionResult.data;
          expect(data.artist.name).toBe('Vianney')
          expect(data.artist.id).toBe('4Nrd0CtP8txoQhnnlRA6V6')
          expect(data.artist.albums[0].id).toBe('3sb3TaTkw7pdVD2V5cSBGi')
          expect(!!executionResult.errors).toBeFalsy();
          expect(artistRequest.isDone()).toBeTruthy();
          expect(artistAlbumsRequest.isDone()).toBeTruthy();
          done();
        }

        let onError = () => { throw 'should not be called' };

        client.query(`
          query {
            artist(id: "4Nrd0CtP8txoQhnnlRA6V6") {
              id
              name
              albums {
                id
              }
            }
          }
        `).then(onSuccess).catch(onError);
      });
    });
  });

  describe('without album_type = "album"', () => {
    let artistResponse = {"external_urls":{"spotify":"https://open.spotify.com/artist/0hEurMDQu99nJRq8pTxO14"},"followers":{"href":null,"total":2104538},"genres":["folk-pop","neo mellow","pop","pop rock","singer-songwriter"],"href":"https://api.spotify.com/v1/artists/0hEurMDQu99nJRq8pTxO14","id":"0hEurMDQu99nJRq8pTxO14","images":[{"height":640,"url":"https://i.scdn.co/image/96a2e527431f7bf39cea4bf8702fc8159f08e2aa","width":640},{"height":320,"url":"https://i.scdn.co/image/5141cdd3e766fdf922fac1fb1ffb404b7536c8cd","width":320},{"height":160,"url":"https://i.scdn.co/image/f0e8d6a32549e39ed2d13f79e1f6561bcd44cc1f","width":160}],"name":"John Mayer","popularity":81,"type":"artist","uri":"spotify:artist:0hEurMDQu99nJRq8pTxO14"};
    let artistAlbums = {"href":"https://api.spotify.com/v1/artists/0hEurMDQu99nJRq8pTxO14/albums?offset=0&limit=20&album_type=album","items":[{"album_type":"album","artists":[{"external_urls":{"spotify":"https://open.spotify.com/artist/0hEurMDQu99nJRq8pTxO14"},"href":"https://api.spotify.com/v1/artists/0hEurMDQu99nJRq8pTxO14","id":"0hEurMDQu99nJRq8pTxO14","name":"John Mayer","type":"artist","uri":"spotify:artist:0hEurMDQu99nJRq8pTxO14"}],"available_markets":["AD","AR","AT","AU","BE","BG","BO","BR","CA","CH","CL","CO","CR","CY","CZ","DE","DK","DO","EC","EE","ES","FI","FR","GB","GR","GT","HK","HN","HU","ID","IE","IS","IT","JP","LI","LT","LU","LV","MC","MT","MX","MY","NI","NL","NO","NZ","PA","PE","PH","PL","PT","PY","SE","SG","SK","SV","TR","TW","US","UY"],"external_urls":{"spotify":"https://open.spotify.com/album/712VoD72K500yLhhgqCyVe"},"href":"https://api.spotify.com/v1/albums/712VoD72K500yLhhgqCyVe","id":"712VoD72K500yLhhgqCyVe","images":[{"height":640,"url":"https://i.scdn.co/image/a615f09cdf83957cde9e43ca5b96bebed7fae938","width":640},{"height":300,"url":"https://i.scdn.co/image/10d4a40fbabf837ddc0efcbd2be92049de8d63dd","width":300},{"height":64,"url":"https://i.scdn.co/image/dc73a5f26b90c9ddc2e6c3e74fee07b94766faf4","width":64}],"name":"Paradise Valley","type":"album","uri":"spotify:album:712VoD72K500yLhhgqCyVe"},{"album_type":"album","artists":[{"external_urls":{"spotify":"https://open.spotify.com/artist/0hEurMDQu99nJRq8pTxO14"},"href":"https://api.spotify.com/v1/artists/0hEurMDQu99nJRq8pTxO14","id":"0hEurMDQu99nJRq8pTxO14","name":"John Mayer","type":"artist","uri":"spotify:artist:0hEurMDQu99nJRq8pTxO14"}],"available_markets":["AD","AR","AT","AU","BE","BG","BO","BR","CA","CH","CL","CO","CR","CY","CZ","DE","DK","DO","EC","EE","ES","FI","FR","GB","GR","GT","HK","HN","HU","ID","IE","IS","IT","JP","LI","LT","LU","LV","MC","MT","MX","MY","NI","NL","NO","NZ","PA","PE","PH","PL","PT","PY","SE","SG","SK","SV","TR","TW","US","UY"],"external_urls":{"spotify":"https://open.spotify.com/album/6S0BIiWtnqU0PtumXMpin0"},"href":"https://api.spotify.com/v1/albums/6S0BIiWtnqU0PtumXMpin0","id":"6S0BIiWtnqU0PtumXMpin0","images":[{"height":640,"url":"https://i.scdn.co/image/e176f41b0424fe163f85d12df116ea15ac7351e2","width":640},{"height":300,"url":"https://i.scdn.co/image/767b3a88dea7774348dfbd061f3335846d3ec560","width":300},{"height":64,"url":"https://i.scdn.co/image/0fa2c2deb0dc1309677b8dae6aba5fcca2469614","width":64}],"name":"Born and Raised","type":"album","uri":"spotify:album:6S0BIiWtnqU0PtumXMpin0"},{"album_type":"album","artists":[{"external_urls":{"spotify":"https://open.spotify.com/artist/0hEurMDQu99nJRq8pTxO14"},"href":"https://api.spotify.com/v1/artists/0hEurMDQu99nJRq8pTxO14","id":"0hEurMDQu99nJRq8pTxO14","name":"John Mayer","type":"artist","uri":"spotify:artist:0hEurMDQu99nJRq8pTxO14"}],"available_markets":["AD","AR","AT","AU","BE","BG","BO","BR","CA","CH","CL","CO","CR","CY","CZ","DE","DK","DO","EC","EE","ES","FI","FR","GB","GR","GT","HN","HU","IE","IS","IT","JP","LI","LT","LU","LV","MC","MT","MX","NI","NL","NO","NZ","PA","PE","PL","PT","PY","SE","SK","SV","TR","US","UY","AD","AR","AT","AU","BE","BG","BO","BR","CA","CH","CL","CO","CR","CY","CZ","DE","DK","DO","EC","EE","ES","FI","FR","GB","GR","GT","HK","HN","HU","ID","IE","IS","IT","JP","LI","LT","LU","LV","MC","MT","MX","MY","NI","NL","NO","NZ","PA","PE","PH","PL","PT","PY","SE","SG","SK","SV","TR","TW","US","UY"],"external_urls":{"spotify":"https://open.spotify.com/album/4Dgxy95K9BWkDUvQPTaYBb"},"href":"https://api.spotify.com/v1/albums/4Dgxy95K9BWkDUvQPTaYBb","id":"4Dgxy95K9BWkDUvQPTaYBb","images":[{"height":640,"url":"https://i.scdn.co/image/132517363ab0fe62a4a7f55e881174b7c928a2c1","width":640},{"height":300,"url":"https://i.scdn.co/image/dac742ebbaa8442dfbd4c8a8004f124fc2f955e9","width":300},{"height":64,"url":"https://i.scdn.co/image/0981d5ffb685e0c585676cc97c3216527c3835a7","width":64}],"name":"Where The Light Is: John Mayer Live In Los Angeles","type":"album","uri":"spotify:album:4Dgxy95K9BWkDUvQPTaYBb"},{"album_type":"album","artists":[{"external_urls":{"spotify":"https://open.spotify.com/artist/0hEurMDQu99nJRq8pTxO14"},"href":"https://api.spotify.com/v1/artists/0hEurMDQu99nJRq8pTxO14","id":"0hEurMDQu99nJRq8pTxO14","name":"John Mayer","type":"artist","uri":"spotify:artist:0hEurMDQu99nJRq8pTxO14"}],"available_markets":["AD","AR","AT","AU","BE","BG","BO","BR","CA","CH","CL","CO","CR","CY","CZ","DE","DK","DO","EC","EE","ES","FI","FR","GB","GR","GT","HK","HN","HU","ID","IE","IS","IT","JP","LI","LT","LU","LV","MC","MT","MX","MY","NI","NL","NO","NZ","PA","PE","PH","PL","PT","PY","SE","SG","SK","SV","TR","TW","US","UY"],"external_urls":{"spotify":"https://open.spotify.com/album/1V5vQRMWTNGmqwxY8jMVou"},"href":"https://api.spotify.com/v1/albums/1V5vQRMWTNGmqwxY8jMVou","id":"1V5vQRMWTNGmqwxY8jMVou","images":[{"height":640,"url":"https://i.scdn.co/image/4b2d6adf523ac55d209f629ef80d2e5383679ec8","width":640},{"height":300,"url":"https://i.scdn.co/image/d8f8e24eb5dd319f1291722b1811b075dade52f0","width":300},{"height":64,"url":"https://i.scdn.co/image/7910cf196db3d268be8dbfacf7443952f185944b","width":64}],"name":"Battle Studies","type":"album","uri":"spotify:album:1V5vQRMWTNGmqwxY8jMVou"},{"album_type":"album","artists":[{"external_urls":{"spotify":"https://open.spotify.com/artist/0hEurMDQu99nJRq8pTxO14"},"href":"https://api.spotify.com/v1/artists/0hEurMDQu99nJRq8pTxO14","id":"0hEurMDQu99nJRq8pTxO14","name":"John Mayer","type":"artist","uri":"spotify:artist:0hEurMDQu99nJRq8pTxO14"}],"available_markets":["AD","AR","AT","AU","BE","BG","BO","BR","CA","CH","CL","CO","CR","CY","CZ","DE","DK","DO","EC","EE","ES","FI","FR","GB","GR","GT","HK","HN","HU","ID","IE","IS","IT","JP","LI","LT","LU","LV","MC","MT","MX","MY","NI","NL","NO","NZ","PA","PE","PH","PL","PT","PY","SE","SG","SK","SV","TR","TW","US","UY"],"external_urls":{"spotify":"https://open.spotify.com/album/1Xsprdt1q9rOzTic7b9zYM"},"href":"https://api.spotify.com/v1/albums/1Xsprdt1q9rOzTic7b9zYM","id":"1Xsprdt1q9rOzTic7b9zYM","images":[{"height":640,"url":"https://i.scdn.co/image/d9cedc03fcc8430a4d2db3c32a6cea2cde6bd737","width":640},{"height":300,"url":"https://i.scdn.co/image/a5ca4d5029cb72802e7ee01f0e538bf8e2f612b5","width":300},{"height":64,"url":"https://i.scdn.co/image/f1c5143cef3c8fe4b42f85766626515a2e45798f","width":64}],"name":"Continuum","type":"album","uri":"spotify:album:1Xsprdt1q9rOzTic7b9zYM"},{"album_type":"album","artists":[{"external_urls":{"spotify":"https://open.spotify.com/artist/0hEurMDQu99nJRq8pTxO14"},"href":"https://api.spotify.com/v1/artists/0hEurMDQu99nJRq8pTxO14","id":"0hEurMDQu99nJRq8pTxO14","name":"John Mayer","type":"artist","uri":"spotify:artist:0hEurMDQu99nJRq8pTxO14"}],"available_markets":["AD","AR","AT","AU","BE","BG","BO","BR","CA","CH","CL","CO","CR","CY","CZ","DE","DK","DO","EC","EE","ES","FI","FR","GB","GR","GT","HK","HN","HU","ID","IE","IS","IT","JP","LI","LT","LU","LV","MC","MT","MX","MY","NI","NL","NO","NZ","PA","PE","PH","PL","PT","PY","SE","SG","SK","SV","TR","TW","US","UY"],"external_urls":{"spotify":"https://open.spotify.com/album/1hC2L9ZBeCSUsh6w3xzqN7"},"href":"https://api.spotify.com/v1/albums/1hC2L9ZBeCSUsh6w3xzqN7","id":"1hC2L9ZBeCSUsh6w3xzqN7","images":[{"height":640,"url":"https://i.scdn.co/image/cb68c1687c5829dac26fbc509447485c130c39a1","width":640},{"height":300,"url":"https://i.scdn.co/image/edb80b5ea95a499e9d569ce747ed052f801d337e","width":300},{"height":64,"url":"https://i.scdn.co/image/ce1df8fdf4c4e6c069443a09479607e7b3a58344","width":64}],"name":"As/Is: Philadelphia, PA/Hartford, CT - 8/14-8/15/04","type":"album","uri":"spotify:album:1hC2L9ZBeCSUsh6w3xzqN7"},{"album_type":"album","artists":[{"external_urls":{"spotify":"https://open.spotify.com/artist/0hEurMDQu99nJRq8pTxO14"},"href":"https://api.spotify.com/v1/artists/0hEurMDQu99nJRq8pTxO14","id":"0hEurMDQu99nJRq8pTxO14","name":"John Mayer","type":"artist","uri":"spotify:artist:0hEurMDQu99nJRq8pTxO14"}],"available_markets":["AD","AR","AT","AU","BE","BG","BO","BR","CA","CH","CL","CO","CR","CY","CZ","DE","DK","DO","EC","EE","ES","FI","FR","GB","GR","GT","HK","HN","HU","ID","IE","IS","IT","JP","LI","LT","LU","LV","MC","MT","MX","MY","NI","NL","NO","NZ","PA","PE","PH","PL","PT","PY","SE","SG","SK","SV","TR","TW","US","UY"],"external_urls":{"spotify":"https://open.spotify.com/album/0u3x6X6FRE23fJEhPJoo6Q"},"href":"https://api.spotify.com/v1/albums/0u3x6X6FRE23fJEhPJoo6Q","id":"0u3x6X6FRE23fJEhPJoo6Q","images":[{"height":640,"url":"https://i.scdn.co/image/d12412f02beb0815b99c99efe8159837f9e67d37","width":640},{"height":300,"url":"https://i.scdn.co/image/616fdf82bf81c97cb5b9e5c78ca63ea643abcf96","width":300},{"height":64,"url":"https://i.scdn.co/image/7be682101af340da1943e37ec26c1a2a3f232c5d","width":64}],"name":"As/Is: Cleveland/Cincinnati, OH - 8/03-8/04/04","type":"album","uri":"spotify:album:0u3x6X6FRE23fJEhPJoo6Q"},{"album_type":"album","artists":[{"external_urls":{"spotify":"https://open.spotify.com/artist/0hEurMDQu99nJRq8pTxO14"},"href":"https://api.spotify.com/v1/artists/0hEurMDQu99nJRq8pTxO14","id":"0hEurMDQu99nJRq8pTxO14","name":"John Mayer","type":"artist","uri":"spotify:artist:0hEurMDQu99nJRq8pTxO14"}],"available_markets":["AD","AR","AT","AU","BE","BG","BO","BR","CA","CH","CL","CO","CR","CY","CZ","DE","DK","DO","EC","EE","ES","FI","FR","GB","GR","GT","HK","HN","HU","ID","IE","IS","IT","JP","LI","LT","LU","LV","MC","MT","MX","MY","NI","NL","NO","NZ","PA","PE","PH","PL","PT","PY","SE","SG","SK","SV","TR","TW","US","UY"],"external_urls":{"spotify":"https://open.spotify.com/album/5gsTckUr9I4z7uFHMheffb"},"href":"https://api.spotify.com/v1/albums/5gsTckUr9I4z7uFHMheffb","id":"5gsTckUr9I4z7uFHMheffb","images":[{"height":640,"url":"https://i.scdn.co/image/ed578161ed1256e0a7123c64bb38e21c4628329a","width":640},{"height":300,"url":"https://i.scdn.co/image/4764ee59e33b5b11814890b075ec81bef11565b8","width":300},{"height":64,"url":"https://i.scdn.co/image/0c7f30b7dc491060827cdf4e6e85e3bebb1e99fe","width":64}],"name":"As/Is: Houston, TX - 7/24/04","type":"album","uri":"spotify:album:5gsTckUr9I4z7uFHMheffb"},{"album_type":"album","artists":[{"external_urls":{"spotify":"https://open.spotify.com/artist/0hEurMDQu99nJRq8pTxO14"},"href":"https://api.spotify.com/v1/artists/0hEurMDQu99nJRq8pTxO14","id":"0hEurMDQu99nJRq8pTxO14","name":"John Mayer","type":"artist","uri":"spotify:artist:0hEurMDQu99nJRq8pTxO14"}],"available_markets":["DE"],"external_urls":{"spotify":"https://open.spotify.com/album/4rBHg7R3tDXJirsOrp4vG4"},"href":"https://api.spotify.com/v1/albums/4rBHg7R3tDXJirsOrp4vG4","id":"4rBHg7R3tDXJirsOrp4vG4","images":[{"height":640,"url":"https://i.scdn.co/image/c8068f94c007923f99d46baf2b2b56e34a8a293f","width":640},{"height":300,"url":"https://i.scdn.co/image/15b2a0fa5d4a3463e73491792e7dd2bab3286db5","width":300},{"height":64,"url":"https://i.scdn.co/image/fb43d171ac1c1079e4ed3d3ed514d002b8e91fb0","width":64}],"name":"As/Is: Houston, TX - 7/24/04","type":"album","uri":"spotify:album:4rBHg7R3tDXJirsOrp4vG4"},{"album_type":"album","artists":[{"external_urls":{"spotify":"https://open.spotify.com/artist/0hEurMDQu99nJRq8pTxO14"},"href":"https://api.spotify.com/v1/artists/0hEurMDQu99nJRq8pTxO14","id":"0hEurMDQu99nJRq8pTxO14","name":"John Mayer","type":"artist","uri":"spotify:artist:0hEurMDQu99nJRq8pTxO14"}],"available_markets":["AD","AR","AT","AU","BE","BG","BO","BR","CA","CH","CL","CO","CR","CY","CZ","DE","DK","DO","EC","EE","ES","FI","FR","GB","GR","GT","HK","HN","HU","ID","IE","IS","IT","JP","LI","LT","LU","LV","MC","MT","MX","MY","NI","NL","NO","NZ","PA","PE","PH","PL","PT","PY","SE","SG","SK","SV","TR","TW","US","UY"],"external_urls":{"spotify":"https://open.spotify.com/album/4ZxNekqkeVlCYcNdD0mnD7"},"href":"https://api.spotify.com/v1/albums/4ZxNekqkeVlCYcNdD0mnD7","id":"4ZxNekqkeVlCYcNdD0mnD7","images":[{"height":640,"url":"https://i.scdn.co/image/8d6d306956f6af3f52413cc0ad1fbac07e5fa40f","width":640},{"height":300,"url":"https://i.scdn.co/image/731845298e2fd801a13742babe0307ed562e34b6","width":300},{"height":64,"url":"https://i.scdn.co/image/a6bdf62f3bf1f41f32dbf96b27c408d3892106a7","width":64}],"name":"As/Is: Mountain View, CA - 7/16/04","type":"album","uri":"spotify:album:4ZxNekqkeVlCYcNdD0mnD7"},{"album_type":"album","artists":[{"external_urls":{"spotify":"https://open.spotify.com/artist/0hEurMDQu99nJRq8pTxO14"},"href":"https://api.spotify.com/v1/artists/0hEurMDQu99nJRq8pTxO14","id":"0hEurMDQu99nJRq8pTxO14","name":"John Mayer","type":"artist","uri":"spotify:artist:0hEurMDQu99nJRq8pTxO14"}],"available_markets":["AD","AR","AT","AU","BE","BG","BO","BR","CA","CH","CL","CO","CR","CY","CZ","DE","DK","DO","EC","EE","ES","FI","FR","GB","GR","GT","HK","HN","HU","ID","IE","IS","IT","JP","LI","LT","LU","LV","MC","MT","MX","MY","NI","NL","NO","NZ","PA","PE","PH","PL","PT","PY","SE","SG","SK","SV","TR","TW","US","UY"],"external_urls":{"spotify":"https://open.spotify.com/album/1QRIX6BuSGegYwiAZOv4R5"},"href":"https://api.spotify.com/v1/albums/1QRIX6BuSGegYwiAZOv4R5","id":"1QRIX6BuSGegYwiAZOv4R5","images":[{"height":628,"url":"https://i.scdn.co/image/333b19f6df335ebcc42fa1a194aecd7e95af0120","width":640},{"height":294,"url":"https://i.scdn.co/image/37434121cf163696b6e6316ecac1125692122df1","width":300},{"height":63,"url":"https://i.scdn.co/image/b150622b20f7b59a325e26c54de9d3041903ebcc","width":64}],"name":"As/Is","type":"album","uri":"spotify:album:1QRIX6BuSGegYwiAZOv4R5"},{"album_type":"album","artists":[{"external_urls":{"spotify":"https://open.spotify.com/artist/0hEurMDQu99nJRq8pTxO14"},"href":"https://api.spotify.com/v1/artists/0hEurMDQu99nJRq8pTxO14","id":"0hEurMDQu99nJRq8pTxO14","name":"John Mayer","type":"artist","uri":"spotify:artist:0hEurMDQu99nJRq8pTxO14"}],"available_markets":["AD","AR","AT","AU","BE","BG","BO","BR","CA","CH","CL","CO","CR","CY","CZ","DE","DK","DO","EC","EE","ES","FI","FR","GB","GR","GT","HK","HN","HU","ID","IE","IS","IT","JP","LI","LT","LU","LV","MC","MT","MX","MY","NI","NL","NO","NZ","PA","PE","PH","PL","PT","PY","SE","SG","SK","SV","TR","TW","US","UY"],"external_urls":{"spotify":"https://open.spotify.com/album/6WivmTXugLZLmAWnZhlz7g"},"href":"https://api.spotify.com/v1/albums/6WivmTXugLZLmAWnZhlz7g","id":"6WivmTXugLZLmAWnZhlz7g","images":[{"height":640,"url":"https://i.scdn.co/image/431b95063028599f2e885b0f9f3b1753cccba59a","width":640},{"height":300,"url":"https://i.scdn.co/image/3a0f75c4f1dbe53778cc656f8e52e84ed7f63caa","width":300},{"height":64,"url":"https://i.scdn.co/image/169bf4de214218e6856473fbd3738afa960b6d0f","width":64}],"name":"Heavier Things","type":"album","uri":"spotify:album:6WivmTXugLZLmAWnZhlz7g"},{"album_type":"album","artists":[{"external_urls":{"spotify":"https://open.spotify.com/artist/0hEurMDQu99nJRq8pTxO14"},"href":"https://api.spotify.com/v1/artists/0hEurMDQu99nJRq8pTxO14","id":"0hEurMDQu99nJRq8pTxO14","name":"John Mayer","type":"artist","uri":"spotify:artist:0hEurMDQu99nJRq8pTxO14"}],"available_markets":["AD","AR","AT","AU","BE","BG","BO","BR","CA","CH","CL","CO","CR","CY","CZ","DE","DK","DO","EC","EE","ES","FI","FR","GB","GR","GT","HK","HN","HU","ID","IE","IS","IT","JP","LI","LT","LU","LV","MC","MT","MX","MY","NI","NL","NO","NZ","PA","PE","PH","PL","PT","PY","SE","SG","SK","SV","TR","TW","US","UY"],"external_urls":{"spotify":"https://open.spotify.com/album/31Q7DQ751hbCO98r1ODhGt"},"href":"https://api.spotify.com/v1/albums/31Q7DQ751hbCO98r1ODhGt","id":"31Q7DQ751hbCO98r1ODhGt","images":[{"height":640,"url":"https://i.scdn.co/image/e0ef9a2969b4caace8ee95c1b98c878aef0bda01","width":640},{"height":300,"url":"https://i.scdn.co/image/ec1d38ef4254305b125ceb1d8dd5680ed8b44308","width":300},{"height":64,"url":"https://i.scdn.co/image/a6f107ad61344bd782df36f69d3f4afdd4968f4b","width":64}],"name":"Any Given Thursday","type":"album","uri":"spotify:album:31Q7DQ751hbCO98r1ODhGt"},{"album_type":"album","artists":[{"external_urls":{"spotify":"https://open.spotify.com/artist/0hEurMDQu99nJRq8pTxO14"},"href":"https://api.spotify.com/v1/artists/0hEurMDQu99nJRq8pTxO14","id":"0hEurMDQu99nJRq8pTxO14","name":"John Mayer","type":"artist","uri":"spotify:artist:0hEurMDQu99nJRq8pTxO14"}],"available_markets":["ID"],"external_urls":{"spotify":"https://open.spotify.com/album/63dnCQnCOfPpLQU1aZvKE7"},"href":"https://api.spotify.com/v1/albums/63dnCQnCOfPpLQU1aZvKE7","id":"63dnCQnCOfPpLQU1aZvKE7","images":[{"height":640,"url":"https://i.scdn.co/image/f58a002a4f44de730d6b45355e86aa5f235540f6","width":640},{"height":300,"url":"https://i.scdn.co/image/701217f5cf132067d84ffb8cd1776d9ca4b3cc73","width":300},{"height":64,"url":"https://i.scdn.co/image/529520f2add8008bd40d83f1942aa95aa3c9d0d2","width":64}],"name":"Any Given Thursday","type":"album","uri":"spotify:album:63dnCQnCOfPpLQU1aZvKE7"},{"album_type":"album","artists":[{"external_urls":{"spotify":"https://open.spotify.com/artist/0hEurMDQu99nJRq8pTxO14"},"href":"https://api.spotify.com/v1/artists/0hEurMDQu99nJRq8pTxO14","id":"0hEurMDQu99nJRq8pTxO14","name":"John Mayer","type":"artist","uri":"spotify:artist:0hEurMDQu99nJRq8pTxO14"}],"available_markets":["AD","AR","AT","AU","BE","BG","BO","BR","CA","CH","CL","CO","CR","CY","CZ","DE","DK","DO","EC","EE","ES","FI","FR","GB","GR","GT","HK","HN","HU","ID","IE","IS","IT","JP","LI","LT","LU","LV","MC","MT","MX","MY","NI","NL","NO","NZ","PA","PE","PH","PL","PT","PY","SE","SG","SK","SV","TR","TW","US","UY"],"external_urls":{"spotify":"https://open.spotify.com/album/3yHOaiXecTJVUdn7mApZ48"},"href":"https://api.spotify.com/v1/albums/3yHOaiXecTJVUdn7mApZ48","id":"3yHOaiXecTJVUdn7mApZ48","images":[{"height":640,"url":"https://i.scdn.co/image/c8a60bd180d5efe02e44cb44634802fbc95f8e49","width":640},{"height":300,"url":"https://i.scdn.co/image/cbdd176f725d10a1e00e273789ec4519dfaecf1d","width":300},{"height":64,"url":"https://i.scdn.co/image/624637f092c08987bb64be13d4eec9ed43d34b12","width":64}],"name":"Room For Squares","type":"album","uri":"spotify:album:3yHOaiXecTJVUdn7mApZ48"},{"album_type":"album","artists":[{"external_urls":{"spotify":"https://open.spotify.com/artist/0hEurMDQu99nJRq8pTxO14"},"href":"https://api.spotify.com/v1/artists/0hEurMDQu99nJRq8pTxO14","id":"0hEurMDQu99nJRq8pTxO14","name":"John Mayer","type":"artist","uri":"spotify:artist:0hEurMDQu99nJRq8pTxO14"}],"available_markets":["AD","AR","AT","AU","BE","BG","BO","BR","CA","CH","CL","CO","CR","CY","CZ","DE","DK","DO","EC","EE","ES","FI","FR","GB","GR","GT","HK","HN","HU","ID","IE","IS","IT","JP","LI","LT","LU","LV","MC","MT","MX","MY","NI","NL","NO","NZ","PA","PE","PH","PL","PT","PY","SE","SG","SK","SV","TR","TW","US","UY"],"external_urls":{"spotify":"https://open.spotify.com/album/5KMP6XLSrhsswEuN2A9VO2"},"href":"https://api.spotify.com/v1/albums/5KMP6XLSrhsswEuN2A9VO2","id":"5KMP6XLSrhsswEuN2A9VO2","images":[{"height":640,"url":"https://i.scdn.co/image/4fefd25928cc89dfdf44ddfd5451f76d67158788","width":640},{"height":300,"url":"https://i.scdn.co/image/44ceccd37568a445ff6e3fb6188b51fc4cc68286","width":300},{"height":64,"url":"https://i.scdn.co/image/e4223b74a9343d73fcef367959d85556583d8b61","width":64}],"name":"Inside Wants Out","type":"album","uri":"spotify:album:5KMP6XLSrhsswEuN2A9VO2"}],"limit":20,"next":null,"offset":0,"previous":null,"total":16};

    nock.disableNetConnect();

    let client = SpotifyGraphQLClient({
      clientId: "clientId",
      clientSecret: "clientSecret",
      redirectUri: "http://redirectUri.dev",
      accessToken: "accessToken"
    });


    describe('when fetching an existing Artist', () => {
      let artistRequest, artistAlbumsRequest;
      beforeEach(() => {
        artistRequest = nock('https://api.spotify.com:443')
          .get('/v1/artists/0hEurMDQu99nJRq8pTxO14')
          .reply(200, artistResponse);
        artistAlbumsRequest = nock('https://api.spotify.com:443')
          .get('/v1/artists/0hEurMDQu99nJRq8pTxO14/albums?album_type=album&offset=0&limit=50')
          .reply(200, artistAlbums);
      });
      afterEach(() =>  {
        nock.cleanAll();
      });

      it('should call promise success callback', (done) => {
        let onSuccess = function (executionResult: any) {
          let data = executionResult.data;
          expect(data.artist.name).toBe('John Mayer')
          expect(data.artist.id).toBe('0hEurMDQu99nJRq8pTxO14')
          expect(data.artist.albums[0].id).toBe('712VoD72K500yLhhgqCyVe')
          expect(!!executionResult.errors).toBeFalsy();
          expect(artistRequest.isDone()).toBeTruthy();
          expect(artistAlbumsRequest.isDone()).toBeTruthy();
          done();
        }

        let onError = () => { throw 'should not be called' };

        client.query(`
          query {
            artist(id: "0hEurMDQu99nJRq8pTxO14") {
              id
              name
              albums(album_type: "album") {
                id
              }
            }
          }
        `).then(onSuccess).catch(onError);
      });
    });
  });

});
